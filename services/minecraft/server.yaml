---
apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
  name: minecraft-server
  namespace: minecraft
spec:
  chart:
    spec:
      chart: minecraft
      sourceRef:
        kind: HelmRepository
        namespace: flux
        name: minecraft
      version: 4.x.x
  interval: 15s
  values:
    image:
      tag: latest
    podSecurityContext:
      runAsNonRoot: false
    resources:
      requests:
        cpu: 10m
        memory: 16Mi
      limits:
        cpu: 2
        memory: 16Gi
    minecraftServer:
      eula: "TRUE"
      type: "VANILLA"
      version: "1.7.10"
      difficulty: "normal"
      ops: "SADarkoro"
      maxPlayers: 5
      maxTickTime: -1
      spawnProtection: 0
      motd: "IFA2B in Direwolf weil Baum"
      onlineMode: "default"
      memory: "8192Mi"
      jvmOpts: "-Djava.awt.headless=true -XX:+UnlockExperimentalVMOptions -XX:+UseG1GC -XX:G1NewSizePercent=20 -XX:G1ReservePercent=20 -XX:MaxGCPauseMillis=50 -XX:G1HeapRegionSize=32M"
      externalIPs:
        - 192.168.1.15
    persistence:
      storageClass: ceph-rbd
      dataDir:
        enabled: true
        Size: 10Gi