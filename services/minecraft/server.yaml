---
apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
  name: minecraft-server
  namespace: minecraft
spec:
  chart:
    spec:
      chart: minecraft
      sourceRef:
        kind: HelmRepository
        namespace: flux
        name: minecraft
      version: 4.x.x
  interval: 15s
  timeout: 2m
  values:
    image:
      tag: java8
    podSecurityContext:
      runAsNonRoot: false
    resources:
      requests:
        cpu: 10m
        memory: 16Mi
      limits:
        cpu: 2
        memory: 16Gi
    minecraftServer:
      eula: "TRUE"
      type: "FORGE"
      genericPack: "https://mediafilez.forgecdn.net/files/3086/774/FTB%20Presents%20Direwolf20%201.12-2.8.0.zip"
      overrideServerProperties: true
      version: "1.12.2"
      difficulty: "normal"
      ops: "SADarkoro"
      levelType: "LARGEBIOMES"
      worldSaveName: "dw20"
      maxPlayers: 5
      maxTickTime: -1
      spawnProtection: 0
      motd: "IFA2B in Direwolf weil Baum"
      onlineMode: "default"
      memory: 8192M
      jvmOpts: "-Djava.awt.headless=true -XX:+UnlockExperimentalVMOptions -XX:+UseG1GC -XX:G1NewSizePercent=20 -XX:G1ReservePercent=20 -XX:MaxGCPauseMillis=50 -XX:G1HeapRegionSize=32M"
      externalIPs:
        - 192.168.1.15
      rcon:
        enabled: true
        password: 8ujbDfZVM6PLppLR7AmmrBowCxRt2@.u
        serviceType: LoadBalancer
        loadBalancerIP: 192.168.1.15
    persistence:
      storageClass: ceph-rbd
      dataDir:
        enabled: true
        Size: 10Gi
